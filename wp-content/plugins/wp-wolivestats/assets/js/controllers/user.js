angular.module("Wolive").controller("UserController",["$scope","$rootScope","$timeout","$routeParams","ajaxAdmin","Functions","moment",function(t,e,a,o,n,i,s){var r=this;r.getIconBrow=i.classBrowser,r.getSO=i.classSO,r.getIconAction=i.classAction,r.getTypeReferer=i.classReferer,t.$on("$viewContentLoaded",function(){i.setFocusEvents(function(e){t.isFocus=e})}),t.$on("$destroy",function(){a.cancel(t.timer_scope)}),r.reloadOverview=function(){var t={action:"getUser",id:o.id};n.newRequest(t,function(t){r.user=t.data.user,r.actions=t.data.actions})},r.getUser=function(){var e={action:"getUser",id:r.id};n.newRequest(e,function(e){r.data=e.data.user,r.data.metadata&&(r.data.metadata.user_registered=(Date.now()/1e3|0)-r.data.metadata.user_registered),r.data.first_seen=(Date.now()/1e3|0)-r.data.first_seen,r.data.last_action=(Date.now()/1e3|0)-r.data.last_action,r.actions=e.data.actions,r.groupAct=r.processGroupActions(r.actions),t.timer_scope=a(r.getActions,wolive_scoopeTime)})},r.getActions=function(){var e={action:"getUser",id:r.id,ignoreLoadingBar:!0,timestamp:r.actions[0].timestamp};n.newRequest(e,function(e){e.data.actions&&(wolive.audioNotificacion.play(),r.processGroupActionsAdd(e.data.actions),e.data.user.metadata&&(r.data.metadata=e.data.user.metadata)),t.timer_scope=a(r.getActions,wolive_scoopeTime)})},r.processGroupActions=function(t){var e={};if(!t.length)return!1;for(var a=0;a<t.length;a++){var o=s(t[a].date).format("MM/DD/YYYY");e[o]||(e[o]={},e[o].date=t[a].date,e[o].actions=[]),t[a].time=(Date.now()/1e3|0)-t[a].diff,e[o].actions.push(t[a])}return e},r.processGroupActionsAdd=function(t){t=t.reverse();for(var e=0;e<t.length;e++){var a=s(t[e].date).format("MM/DD/YYYY");r.groupAct[a]||(r.groupAct[a]={},r.groupAct[a].date=t[e].date,r.groupAct[a].actions=[]),t[e].addClass="animateAction",t[e].time=(Date.now()/1e3|0)-t[e].diff,r.groupAct[a].actions.unshift(t[e]),r.actions.unshift(t[e])}},t.$watch("user_",function(){a.cancel(t.timer_scope),t.user_>0&&(r.id=t.user_,r.data=!1,r.groupAct=null,r.actions=null,r.getUser())}),t.$watch("user_init",function(){r.id=parseInt(t.user_init),r.id>0?r.getUser():t.user_init=null})}]),angular.module("Wolive").controller("tabsUser",function(t,e){});